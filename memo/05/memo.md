## コンパイル処理

前処理 -> 変換処理 -> 結合

- プリプロセッサ - プリプロセス
    - コンパイラ - コンパイル
        - リンカ - リンク

### プリプロセッサ

入力プログラムを、それと同じ言語だが
異なる内容にしたプログラムを出力する

今回でいうと、.asmファイルを受け取り
後続処理が解釈しやすい.asmファイルを出力する

```
%define cat_count 42

mov rax, cat_count
```

```
$ nasm -E define_cat_count.asm
%line 2+1 define_cat_count.asm

mov rax, 42
```

プリプロセスにより
cat_count　が定義した42で置き換えられる

**NASMでは既存のプリプロセッサシンボル(広義にいう変数シンボル)を再定義できる**

single line のマクロは `%define` が使われる
マクロ内で他のマクロを呼ぶこともできる

### コンパイラ

前段で処理したソースファイルをマシン語の命令に変換し
エンコードされたオブジェクトファイルを出力する

ここまでだと、複数ファイルがコンパイルされた場合に
それぞれの依存がある場合を解決できていない

#### マクロ

- 入力に依存する計算はできない(使えるのは定数のみ)
- 繰り返しのサイクルは固定回数より多くできない -> whileは不可

### リンカ

コンパイル処理で生成された成果物を結合して実行可能なファイルを作る

### ローダ

実行可能バイナリを受け取る
プロセス実行時のアドレスに受け取ったファイルの命令など
メタデータを書き込む

